<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Posts</title>
</head>
<body>

<div id="posts"></div>

<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script>
    function test(id) {
        console.log("Yaaai!" + id);
        fetch("/api/posts/" + id, {
            method: "DELETE"
        });
        reloadData();
    }

    function reloadData() {
        $.ajax({
            url: "/api/posts",
            type: "GET",
            contentType: "application/json; charset=utf-8",
            success: function (resultData) {
                console.log(resultData);

                // Clear container (optional)
                $("#posts").empty();

                // Loop through posts
                $.each(resultData, function (index, post) {
                    $("#posts").append(`
                        <div class="post">
                            <p class="post-content">${post.content}</p>
                            <small class="post-date">${new Date(post.createdAt).toLocaleString()}</small>
                            <button type="button" onclick="test(${post.id})">Delete post</button>
                        </div>
                    `);
                });
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.error("Error:", textStatus);
            },
            timeout: 120000
        });
    }

    reloadData();
</script>
</body>
</html>
